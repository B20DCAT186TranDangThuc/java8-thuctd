<html>
<head th:replace="admin/layout/head :: head"></head>
<body>

<nav th:replace="admin/layout/header :: header"></nav>

<nav th:replace="admin/layout/sidebar :: sidebar"></nav>

<!--Content-->
<div class="be-content" style="margin-top: 60px;">
    <div class="main-content container-fluid">
        <div class="page-head">
            <h2 class="page-head-title">Product Management</h2>
            <nav aria-label="breadcrumb" role="navigation">
                <ol class="breadcrumb page-head-nav">
                    <li class="breadcrumb-item active">Product List</li>
                </ol>
            </nav>
        </div>

        <div class="form-group row p-4">
            <div class="col-12 col-sm-5 col-lg-4">
                <form action="/user" method="get" class="input-group input-search">
                    <input class="form-control" type="text" name="keyword" placeholder="Search"
                    >
                    <span class="input-group-btn">
                                            <button class="btn btn-secondary" type="submit"><i
                                                    class="icon mdi mdi-search"></i></button>
                                        </span>
                </form>
            </div>
            <div class="col-12 col-sm-5 col-lg-3 mb-2 mb-sm-0">
                <form action="/user" method="get" style="height: 100%;">
                    <input type="hidden" name="keyword" value="${keyword}">
                </form>
            </div>
            <div class="col-12 col-sm-2 col-lg-5 d-flex justify-content-end">
                <a th:href="@{/admin/products/add}" class="btn d-flex justify-content-center align-items-center"
                   style="border-radius: 50%;width: 40px; height: 40px">
                    <img th:src="@{/assets/img/add.png}" style="width: 50px; height: 50px";/>
                </a>
            </div>
        </div>

        <div class="col-sm-12">
            <div class="card card-table">
                <div class="card-body">
                    <div id="table2_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
                        <div class="row be-datatable-body">
                            <div class="col-sm-12">
                                <table
                                        class="table table-striped table-hover table-fw-widget dataTable no-footer"
                                        id="table2" role="grid" aria-describedby="table2_info">
                                    <thead>
                                    <tr role="row">
                                        <th class="text-center" tabindex="0"
                                            aria-controls="table2" rowspan="1" colspan="1"
                                            aria-sort="ascending"
                                            aria-label="Rendering engine: activate to sort column descending"
                                            style="width: 100px;">Code</th>
                                        <th class="text-center" tabindex="0"
                                            aria-controls="table2" rowspan="1" colspan="1"
                                            aria-label="Browser: activate to sort column ascending"
                                            style="width: 220px;">Name</th>
                                        <th class="text-center" tabindex="0"
                                            aria-controls="table2" rowspan="1" colspan="1"
                                            aria-label="Platform(s): activate to sort column ascending"
                                            style="width: 200px;">Price</th>
                                        <th class="text-center" tabindex="0"
                                            aria-controls="table2" rowspan="1" colspan="1"
                                            aria-label="CSS grade: activate to sort column ascending"
                                            style="width: 120px;">Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="product : ${products}" class="gradeA odd" role="row">
                                        <td class="text-center" th:text="${product.code}"></td>
                                        <td class="text-center" th:text="${product.name}"></td>
                                        <td class="text-center" >
                                            <span th:inline="text">[[${#numbers.formatDecimal(product.price, 0, 'COMMA', 2, 'POINT')}]] VND</span>
                                        </td>
                                        <td class="text-center">
                                            <a th:href="@{/admin/products/detail(code=${product.code})}" class="btn btn-secondary">Detail</a>
                                            <a th:href="@{/admin/products/update(code=${product.code})}" class="btn btn-info">Update</a>
                                            <a href="#" th:onclick="confirmDelete([[${product.code}]])" class="btn btn-danger">Delete</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal xác nhận xóa -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteLabel">Confirm Deletion</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this product?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteButton">Delete</button>
            </div>
        </div>
    </div>
</div>

</body>

<div th:replace="admin/layout/scrips :: scrips"></div>
<script>
    var usernameToDelete;

    function confirmDelete(code) {
        console.log(code)
        codeDetail = code; // Lưu username vào biến toàn cục
        $('#confirmDeleteModal').modal('show'); // Hiển thị modal
        document.getElementById("confirmDeleteButton").onclick = function() {
            window.location.href = '/admin/products/delete?code=' + codeDetail; // Chuyển hướng đến URL xóa
        }
    }


</script>
</html>